# ComfyUI MCP Server v2.6.0 Release Notes

## Overview
Version 2.6.0 adds powerful new tools based on comprehensive use case analysis, focusing on workflow automation, intelligent prompt optimization, batch operations, and automated mask generation.

## New Tools (7 total)

### 1. Workflow Preset Management (3 tools)
- **save_workflow_preset** - Save complete workflows as reusable templates
  - Parameters: name, description, workflow, tags, is_public
  - Stores workflows with metadata and usage tracking
  
- **list_workflow_presets** - Browse saved workflow presets
  - Parameters: tags, include_stats
  - Returns presets filtered by tags with usage statistics
  
- **apply_workflow_preset** - Execute saved workflow templates
  - Parameters: preset_name, parameters, track_usage
  - Allows parameter overrides and tracks usage

### 2. Intelligent Prompt Enhancement (2 tools)
- **optimize_prompt_with_ai** - AI-powered prompt improvement
  - Parameters: prompt, optimization_goals, target_style, reference_successful
  - Learns from successful generations
  - Adds quality modifiers, style descriptors, and detail enhancers
  
- **generate_with_style_preset** - Generate with predefined styles
  - Parameters: prompt, style, quality_preset, auto_optimize
  - Styles: photorealistic, anime, artistic, fantasy, scifi
  - Quality presets: fast, balanced, quality, ultra

### 3. Batch Operations (1 tool)
- **coordinate_batch_operation** - Manage complex multi-step operations
  - Parameters: operation_name, tasks, parallel_limit, error_handling, progress_webhook
  - Supports generate, upscale, and workflow task types
  - Error handling: stop, retry, or continue
  - Progress tracking and webhook notifications

### 4. Automated Masking (1 tool)
- **auto_generate_mask** - Intelligent automatic mask generation
  - Parameters: image_path, target, refinement, preview
  - Targets: foreground, background, edges
  - Refinement levels: low, medium, high
  - Optional preview generation

## Technical Improvements
- Added import guards for optional dependencies (PIL, numpy, scikit-image)
- Improved error handling with helpful dependency installation messages
- Enhanced logging for better debugging
- Added workflow usage tracking and statistics

## Total Tool Count
The server now includes **89 tools** (up from 81 in v2.5.0)

## Use Cases Enabled

### 1. E-commerce Product Pipeline
```python
# Save a product photography workflow
save_workflow_preset(
    name="Product Photography",
    workflow={...},
    tags=["product", "ecommerce"]
)

# Apply it with variations
apply_workflow_preset(
    "Product Photography",
    parameters={"background": "white", "lighting": "studio"}
)
```

### 2. Content Creation Factory
```python
# Optimize prompts for social media
optimized = optimize_prompt_with_ai(
    "sunset beach photo",
    optimization_goals=["engagement", "clarity"],
    target_style="instagram"
)

# Generate with style presets
generate_with_style_preset(
    optimized["optimized_prompt"],
    style="photorealistic",
    quality_preset="ultra"
)
```

### 3. Batch Processing
```python
# Process multiple images
coordinate_batch_operation(
    "Product Variants",
    tasks=[
        {"type": "generate", "parameters": {...}},
        {"type": "upscale", "parameters": {...}},
        {"type": "workflow", "parameters": {...}}
    ],
    parallel_limit=3
)
```

### 4. Smart Masking
```python
# Auto-generate masks for editing
auto_generate_mask(
    "product.jpg",
    target="background",
    refinement="high",
    preview=True
)
```

## Installation Requirements
- Core MCP server dependencies
- Optional: PIL/Pillow for mask generation
- Optional: numpy for image processing
- Optional: scikit-image, scipy for advanced masking

## Migration from v2.5.0
No breaking changes. All existing tools continue to work as before.

## Future Roadmap
Based on the use case analysis, the next priorities include:
- Multi-ControlNet support
- Platform-specific optimization (social media formats)
- Visual workflow builder API
- Generation cost calculator
- Collaborative features

## Bug Fixes
- Fixed missing startup_time variable
- Consolidated duplicate imports
- Fixed json_lib references
- Improved version consistency